#############################################################
## JOB DESCRIPTION                                         ##
#############################################################

# NpT EQUILIBRATION (STEP 3)

# System solvated with water and 1% NaCl
# 
# 1 ns on NpT ensemble
# 298.15 K / 1.00 atm


#############################################################
## ADJUSTABLE PARAMETERS                                   ##
#############################################################

set inp		   system
set inp2	   eq_NVT
set out		   eq_NpT

set freq	   5000
set temperature    298.15	;# K
set pressure	   1.01325	;# bar
firsttimestep      0


#############################################################
## SIMULATION PARAMETERS                                   ##
#############################################################

# Input
structure           setup/$inp.psf
coordinates         setup/$inp.pdb
bincoordinates	    output/$inp2.coor
binvelocities	    output/$inp2.vel
extendedsystem	    output/$inp2.xsc

paraTypeCharmm      on
parameters          /home/carlos/Dropbox/toppar/par_all36_prot.prm
parameters          /home/carlos/Dropbox/toppar/par_all36_na.prm
parameters          /home/carlos/Dropbox/toppar/par_all36_carb.prm
parameters          /home/carlos/Dropbox/toppar/par_all36_lipid.prm
parameters          /home/carlos/Dropbox/toppar/par_all36_cgenff.prm
parameters          /home/carlos/Dropbox/toppar/cgtbatista/water_ions.str


# Force-Field Parameters
exclude             scaled1-4
oneFourScaling      1.0
cutoff              12.0
switching           on
switchdist          10.0
pairlistdist        14.0


# Integrator Parameters
timestep            2.0  		;# 2fs/step
rigidBonds          all  		;# needed for 2fs steps
nonbondedFreq       1
fullElectFrequency  2  
stepspercycle       10


# Constant Temperature Control
langevin            on   		;# do langevin dynamics
langevinDamping     1    		;# gamma = 1/ps
langevinTemp        $temperature
langevinHydrogen    off  		;# don't couple langevin bath to hydrogens


# Barostat
useGroupPressure      yes
useFlexibleCell       no
useConstantArea       no

langevinPiston        on
langevinPistonTarget  $pressure
langevinPistonPeriod  200.
langevinPistonDecay   100.
langevinPistonTemp    $temperature


# Periodic Boundary Conditions
wrapAll             on


# PME (for full-system periodic electrostatics)
PME                 yes
PMEGridSpacing      1.0


# Output
restartfreq         500  		;# create one restarting point every 1ps

outputname	    output/$out
restartname	    output/$out
DCDfile		    output/$out.dcd

binaryoutput	    yes
binaryrestart	    yes
DCDUnitCell         yes

dcdfreq             $freq
xstFreq             $freq
outputEnergies	    $freq
outputpressure	    $freq
outputtiming	    $freq


#############################################################
## EXTRA PARAMETERS                                        ##
#############################################################

## GPU
GPUResident     on

# nothing to do here...


#############################################################
## EXECUTION SCRIPT                                        ##
#############################################################

# just equilibration
run		    500000 ;# 500000 x 2 fs = 1000000 fs = 1 ns

