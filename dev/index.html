<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · LumberjackToolkit.jl</title><meta name="title" content="Home · LumberjackToolkit.jl"/><meta property="og:title" content="Home · LumberjackToolkit.jl"/><meta property="twitter:title" content="Home · LumberjackToolkit.jl"/><meta name="description" content="Documentation for LumberjackToolkit.jl."/><meta property="og:description" content="Documentation for LumberjackToolkit.jl."/><meta property="twitter:description" content="Documentation for LumberjackToolkit.jl."/><meta property="og:url" content="https://cgtbatista.github.io/LumberjackToolkit.jl/"/><meta property="twitter:url" content="https://cgtbatista.github.io/LumberjackToolkit.jl/"/><link rel="canonical" href="https://cgtbatista.github.io/LumberjackToolkit.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>LumberjackToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cgtbatista/LumberjackToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="LumberjackToolkit"><a class="docs-heading-anchor" href="#LumberjackToolkit">LumberjackToolkit</a><a id="LumberjackToolkit-1"></a><a class="docs-heading-anchor-permalink" href="#LumberjackToolkit" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/cgtbatista/LumberjackToolkit.jl">LumberjackToolkit</a>.</p><ul><li><a href="#LumberjackToolkit._correct_center-Tuple{Vector{Float64}, Float64}"><code>LumberjackToolkit._correct_center</code></a></li><li><a href="#LumberjackToolkit._correct_symmetry-Tuple{Vector{Float64}, Float64}"><code>LumberjackToolkit._correct_symmetry</code></a></li><li><a href="#LumberjackToolkit._get_reference-Tuple{MolSimToolkit.Simulation, String}"><code>LumberjackToolkit._get_reference</code></a></li><li><a href="#LumberjackToolkit._ordering_symmetry-Tuple{Vector{Float64}, Vector{Float64}}"><code>LumberjackToolkit._ordering_symmetry</code></a></li><li><a href="#LumberjackToolkit.align_trajectory-Tuple{String, String, String}"><code>LumberjackToolkit.align_trajectory</code></a></li><li><a href="#LumberjackToolkit.average_bins-Tuple{Vector{Float64}}"><code>LumberjackToolkit.average_bins</code></a></li><li><a href="#LumberjackToolkit.averaging_profile-Tuple{Vector{Vector{Float64}}, Vector{Vector{Float64}}}"><code>LumberjackToolkit.averaging_profile</code></a></li><li><a href="#LumberjackToolkit.binning-Tuple{MolSimToolkit.Simulation}"><code>LumberjackToolkit.binning</code></a></li><li><a href="#LumberjackToolkit.cellulose_surface-Tuple{String}"><code>LumberjackToolkit.cellulose_surface</code></a></li><li><a href="#LumberjackToolkit.densityprofile-Tuple{String, String}"><code>LumberjackToolkit.densityprofile</code></a></li><li><a href="#LumberjackToolkit.dihedral-NTuple{4, StaticArraysCore.SVector}"><code>LumberjackToolkit.dihedral</code></a></li><li><a href="#LumberjackToolkit.dihedrals-Tuple{String, String, String}"><code>LumberjackToolkit.dihedrals</code></a></li><li><a href="#LumberjackToolkit.dispm-Tuple{Vector{&lt;:Vector{StaticArraysCore.SVector{3, Float64}}}}"><code>LumberjackToolkit.dispm</code></a></li><li><a href="#LumberjackToolkit.lovo_mapping-Tuple{String, String}"><code>LumberjackToolkit.lovo_mapping</code></a></li><li><a href="#LumberjackToolkit.msd-Tuple{Vector{Vector{StaticArraysCore.SVector{3, Float64}}}}"><code>LumberjackToolkit.msd</code></a></li><li><a href="#LumberjackToolkit.r_avg-Tuple{Vector{&lt;:Vector{StaticArraysCore.SVector{3, Float64}}}}"><code>LumberjackToolkit.r_avg</code></a></li><li><a href="#LumberjackToolkit.readcoords-Tuple{AbstractVector{&lt;:PDBTools.Atom}, String}"><code>LumberjackToolkit.readcoords</code></a></li><li><a href="#LumberjackToolkit.select_atoms-Tuple{Vector{PDBTools.Atom}, String, String, Int64, String}"><code>LumberjackToolkit.select_atoms</code></a></li><li><a href="#LumberjackToolkit.simsteps-Tuple{Float64, Float64}"><code>LumberjackToolkit.simsteps</code></a></li><li><a href="#LumberjackToolkit.simulation_steps-Tuple{Int64}"><code>LumberjackToolkit.simulation_steps</code></a></li><li><a href="#LumberjackToolkit.vmd_get_charges-Tuple{String, String}"><code>LumberjackToolkit.vmd_get_charges</code></a></li><li><a href="#LumberjackToolkit.write_frame!-Tuple{IO, AbstractVector{&lt;:PDBTools.Atom}, Chemfiles.Frame}"><code>LumberjackToolkit.write_frame!</code></a></li><li><a href="#LumberjackToolkit.writepdb_trajectory-Tuple{String, String}"><code>LumberjackToolkit.writepdb_trajectory</code></a></li><li><a href="#LumberjackToolkit.δ-Tuple{Float64, Float64, Float64}"><code>LumberjackToolkit.δ</code></a></li><li><a href="#LumberjackToolkit.ρ-Tuple{Vector{Float64}, Vector{MolSimToolkit.Point3D{Float64}}, Float64}"><code>LumberjackToolkit.ρ</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit._correct_center-Tuple{Vector{Float64}, Float64}" href="#LumberjackToolkit._correct_center-Tuple{Vector{Float64}, Float64}"><code>LumberjackToolkit._correct_center</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_correct_center(bins::Vector{Float64}, reference::Float64)</code></pre><p>It corrects the bin values based on the referenced center. In this way, the center will become zero and all the bins values will be reajusted to apply it. Now, every distance is compared with the central value.</p><p><strong>Arguments</strong></p><ul><li><code>bins::Vector{Float64}</code>: a Vector{Float64} with the bins.</li><li><code>reference::Float64</code>: a Float64 with the reference center.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/density.jl#L194-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit._correct_symmetry-Tuple{Vector{Float64}, Float64}" href="#LumberjackToolkit._correct_symmetry-Tuple{Vector{Float64}, Float64}"><code>LumberjackToolkit._correct_symmetry</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_correct_symmetry(bins::Vector{Float64}, reference::Float64)</code></pre><p>Do the same thing that <code>_correct_center(...)</code>, but it extends the concept to adjust the data in such way that the center will become the center of the box in every frame.</p><p><strong>Arguments</strong></p><ul><li><code>bins::Vector{Float64}</code>: a Vector{Float64} with the bins.</li><li><code>reference::Float64</code>: a Float64 with the reference center.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/density.jl#L213-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit._get_reference-Tuple{MolSimToolkit.Simulation, String}" href="#LumberjackToolkit._get_reference-Tuple{MolSimToolkit.Simulation, String}"><code>LumberjackToolkit._get_reference</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_get_reference(simulation::MolSimToolkit.Simulation, selection::String)</code></pre><p>It aims to get the reference center for each frame along the trajectory.</p><p><strong>Arguments</strong></p><ul><li><code>simulation::MolSimToolkit.Simulation</code>: a MolSimToolkit.Simulation object.</li><li><code>selection::String</code>: a selection string to get the reference center. For exemple, &quot;all&quot; or &quot;not water&quot;.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/density.jl#L170-L178">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit._ordering_symmetry-Tuple{Vector{Float64}, Vector{Float64}}" href="#LumberjackToolkit._ordering_symmetry-Tuple{Vector{Float64}, Vector{Float64}}"><code>LumberjackToolkit._ordering_symmetry</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_ordering_symmetry(bins::Vector{Float64}, ρ::Vector{Float64})</code></pre><p>This function checks if the bins are ordered after the symmetry protocol and if not, it orders them.</p><p><strong>Arguments</strong></p><ul><li><code>bins::Vector{Float64}</code>: a Vector{Float64} with the bins.</li><li><code>ρ::Vector{Float64}</code>: a Vector{Float64} with the densities.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/density.jl#L140-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.align_trajectory-Tuple{String, String, String}" href="#LumberjackToolkit.align_trajectory-Tuple{String, String, String}"><code>LumberjackToolkit.align_trajectory</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">align_trajectory(psfname::String, pdbname::String, trajectory::String; ...)</code></pre><p>Aligns a trajectory to a reference structure using VMD. It loads the psf, pdb, and trajectory files, wraps the trajectory, and aligns the frames to the reference structure.     The <code>selection</code> argument is used to define the atoms to be aligned based on the VMD selection, such as a protein or a cellulose fibril.     The <code>DebugVMD</code> argument equals  <strong>true</strong> will return  the VMD output. The function returns the path to the new trajectory.     If the <code>new_trajectory</code> argument is not provided, a temporary file is created.</p><p><strong>Arguments</strong></p><ul><li><code>psfname::String</code>: The path to the PSF file.</li><li><code>pdbname::String</code>: The path to the PDB file.</li><li><code>trajectory::String</code>: The path to the trajectory file.</li><li><code>selection::String</code>: The VMD selection to be aligned. Default is &quot;protein&quot;.</li><li><code>pbc_dimensions::String</code>: The PBC dimensions to be set on <strong>pbctools format</strong>. If not provided, the function will try to read the dimensions from the .xsc file, based on the location of trajectory.</li><li><code>new_trajectory::String</code>: The path to the new trajectory file. If not provided, a temporary file is created.</li><li><code>reference::Int</code>: The frame to be used as reference. Default is 0, the initial frame.</li><li><code>vmd::String</code>: The path to the VMD executable. Default is &quot;vmd&quot;.</li><li><code>DebugVMD::Bool</code>: If <strong>true</strong>, the function will return the VMD output. Default is <strong>false</strong>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/align.jl#L1-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.average_bins-Tuple{Vector{Float64}}" href="#LumberjackToolkit.average_bins-Tuple{Vector{Float64}}"><code>LumberjackToolkit.average_bins</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">average_bins(bins::Vector{Float64})</code></pre><p>It takes an average vector based on the binned box parameters. So it can be rightly compare with the ρ density with <span>$length(density) ≡ length(bins) - 1$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/density.jl#L160-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.averaging_profile-Tuple{Vector{Vector{Float64}}, Vector{Vector{Float64}}}" href="#LumberjackToolkit.averaging_profile-Tuple{Vector{Vector{Float64}}, Vector{Vector{Float64}}}"><code>LumberjackToolkit.averaging_profile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">averaging_profile(distances::Vector{Vector{Float64}}, densities::Vector{Vector{Float64}})</code></pre><p>This function takes the <code>distances</code> and <code>densities</code> from Vector{Vector{Float64}} to Vector{Float64} by means and standard deviation computations.</p><p><strong>Arguments</strong></p><ul><li><code>distances::Vector{Vector{Float64}}</code>: a Vector{Vector{Float64}} with the distances from the center of the profile.</li><li><code>densities::Vector{Vector{Float64}}</code>: a Vector{Vector{Float64}} with the densities of the profile.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/density.jl#L121-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.binning-Tuple{MolSimToolkit.Simulation}" href="#LumberjackToolkit.binning-Tuple{MolSimToolkit.Simulation}"><code>LumberjackToolkit.binning</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">binning(simulation::MolSimToolkit.Simulation; axis=&quot;z&quot;, resolution=1.)</code></pre><p>It reports the bins and normalization factor for the loaded simulation box.</p><p><strong>Arguments</strong></p><ul><li><code>simulation::MolSimToolkit.Simulation</code>: a MolSimToolkit.Simulation object.</li><li><code>axis::String</code>: a String with the axis flag.</li><li><code>dimensions::Int</code>: an integer with the number of dimensions. It can be 1 or 2.</li><li><code>resolution::Float64</code>: a Float64 with the resolution of the bins.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/density.jl#L296-L306">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.cellulose_surface-Tuple{String}" href="#LumberjackToolkit.cellulose_surface-Tuple{String}"><code>LumberjackToolkit.cellulose_surface</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">surface(rawfile::String; surface_method=&quot;distance&quot;, selection=&quot;all&quot;, parameters=&quot;-res 0.6 -cutoff 4.0&quot;, vmd=&quot;vmd&quot;)</code></pre><p>Generate a surface from a VMD input file using the <code>volmap</code> plugin. The surface can be generated using different methods, such as <code>distance</code>, <code>density</code>, among others. The default method is <code>distance</code>. The selection can be defined by the user, and the default is <code>all</code>.</p><p>The parameters can be set by the user, and the default is <code>-res 0.6 -cutoff 4.0</code>. The VMD executable can be provided as an argument whether is not on default PATH.</p><p><strong>Arguments</strong></p><ul><li><p><code>rawfile::String</code>: The name of the input file without extension. The script will look for <code>rawfile.pdb</code> and <code>rawfile.psf</code>.</p></li><li><p><code>surface_method::String=&quot;distance&quot;</code>: The method to be used to generate the surface using the volmap tools. The default is <code>distance</code>.   <code>density</code>       creates a map of the weighted atomic density at each gridpoint. This is done by replacing each atom in the selection with a normalized gaussian distribution       of width (standard deviation) equal to its atomic radius. The gaussian distribution for each atom is then weighted using an optional -weight argument, and       defaults to a weight of one (i.e, the number density). The various gaussians are then additively distributed on a grid.   <code>interp</code>       creates a map with the atomic weights interpolated onto a grid. For each atom, its weight is distributed to the 8 nearest voxels via a trilinear interpolation.       The optional -weight argument defaults to a weight of one.   <code>distance</code>       creates a map for which each gridpoint contains the distance between that point and the edge of the nearest atom. In other words, each gridpoint specifies the       maximum radius of a sphere cnetered at that point which does not intersect with the spheres of any other atoms. All atoms are treated as spheres using the       atoms&#39; VMD radii.   <code>coulomb</code>, <code>coulombmsm</code>       Creates a map of the electrostatic field of the atom selection, made by computing the non-bonded Coulomb potential from each atom in the selection (in units       of <strong>k_B.T/e</strong>). The coulomb map generation is optimized to take advantage of multi-core CPUs and programmable GPUs if they are available.   <code>ils</code>       Creates a free energy map of the distribution of a weakly-interacting monoatomic or diatomic gas ligand throughout the system using the Implicit Ligand       Sampling (ILS) technique. See additional information about ILS below.   <code>mask</code>       Creates a map which is set to 0 or 1 depending on whether they are within a specified -cutoff distance argument of any atoms in the selection. The mask map is       typically used in combination with other maps in order to hide/mask data that is far from a region of interest.   <code>occupancy</code>       Each grid point is set to either 0 or 1, depending on whether it contains onbe or more atoms or not. When averaged over many frames, this will provide the       fractional occupancy of that grid point. By default, atoms are treated as spheres using the atomic radii and a gridpoint is considered to be &quot;occupied&quot; if       it lies inside that sphere. Use the -points argument to treat atoms as points (a grid point is &quot;occupied&quot; if its grid cube contains an atom&#39;s center). </p></li><li><p><code>selection::String=&quot;all&quot;</code>: The selection to be used to generate the surface. The default is <code>all</code>.</p></li><li><p><code>parameters::String=&quot;-res 0.6 -cutoff 4.0&quot;</code>: The parameters to be used in the <code>volmap</code> plugin. The default is <code>-res 0.6 -cutoff 4.0</code>. To understand the parameters,  see the VMD documentation https://www.ks.uiuc.edu/Research/vmd/vmd-1.9.4/ug/node157.html.</p></li><li><p><code>vmd::String=&quot;vmd&quot;</code>: The VMD executable. The default is <code>vmd</code>.</p></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">
julia &gt; surface(&quot;new_crystal&quot;)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/dupree.jl#L11-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.densityprofile-Tuple{String, String}" href="#LumberjackToolkit.densityprofile-Tuple{String, String}"><code>LumberjackToolkit.densityprofile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">densityprofile(pdb::String, trajectory::String; ...)</code></pre><p>It computes the density profile for each one of the frames inside the trajectory.</p><p><strong>Arguments</strong></p><ul><li><code>pdb::String</code>: a String with the pdb file path.</li><li><code>trajectory::String</code>: a String with the trajectory file path.</li><li><code>profile::String</code>: a String with the profile type. It can be &quot;number&quot;, &quot;mass&quot;, &quot;charge&quot;, or &quot;electron&quot;.</li><li><code>selection::String</code>: a String with the selection of the atoms.</li><li><code>axis::String</code>: a String with the axis flag.</li><li><code>dimensions::Int</code>: an integer with the number of dimensions. It can be 1 or 2.</li><li><code>resolution::Float64</code>: a Float64 with the resolution of the bins.</li><li><code>center::Bool</code>: a Bool to center the profile.</li><li><code>symmetry::Bool</code>: a Bool to apply the symmetry protocol.</li><li><code>symmetry_selection::String</code>: a String with the selection of the atoms to apply the symmetry protocol.</li><li><code>first::Int</code>: an integer with the first frame to be considered.</li><li><code>step::Int</code>: an integer with the step to be considered.</li><li><code>last::Int</code>: an integer with the last frame to be considered.</li><li><code>charge_column::String</code>: a String with the charge column to be considered.</li><li><code>edp::String</code>: a String with the electron density profile.</li><li><code>charge_correction::Bool</code>: a Bool to apply the charge correction.</li><li><code>normalization::Bool</code>: a Bool to apply the normalization.</li><li><code>echo::Bool</code>: a Bool to print or not the output.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/density.jl#L1-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.dihedral-NTuple{4, StaticArraysCore.SVector}" href="#LumberjackToolkit.dihedral-NTuple{4, StaticArraysCore.SVector}"><code>LumberjackToolkit.dihedral</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dihedral(atom1::StaticArrays.SVector, atom2::StaticArrays.SVector, atom3::StaticArrays.SVector, atom4::StaticArrays.SVector)</code></pre><p>Calculate the dihedral angle between four atoms. The dihedral angle is the angle between the planes defined by the atoms (atom1, atom2, atom3) and (atom2, atom3, atom4). The dihedral angle is calculated using the atan method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/dihedrals.jl#L46-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.dihedrals-Tuple{String, String, String}" href="#LumberjackToolkit.dihedrals-Tuple{String, String, String}"><code>LumberjackToolkit.dihedrals</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>dihedrals(pdbname::String, trajectory::String, segname::String; ...)</p><p>Calculate the dihedral angles and their sum based on the carbohydrate chain. The <code>pdbname</code> carries the atom information, and the <code>trajectory</code> holds the coordinates for each atoms in the simulation. The carbohydrate chain is defined by the <code>segname</code> parameter, that is the same segname present on PDB.</p><p>Wohlert uses a lot the ϕ(O5&#39;-C1&#39;-O4-C4) and ψ(C1&#39;-O4-C4-C3) definition, while Carol uses ϕ(O5&#39;-C1&#39;-O4-C4) and ψ(C1&#39;-O4-C4-C5)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/dihedrals.jl#L66-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.dispm-Tuple{Vector{&lt;:Vector{StaticArraysCore.SVector{3, Float64}}}}" href="#LumberjackToolkit.dispm-Tuple{Vector{&lt;:Vector{StaticArraysCore.SVector{3, Float64}}}}"><code>LumberjackToolkit.dispm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dispm(frames::Vector{&lt;:Vector{SVector{3, Float64}}}, weights::Vector{Float64}; weight_method=nothing)</code></pre><p>Calculate the displacement matrix of a trajectory with weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/pca.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.lovo_mapping-Tuple{String, String}" href="#LumberjackToolkit.lovo_mapping-Tuple{String, String}"><code>LumberjackToolkit.lovo_mapping</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">map_fractions(atoms::AbstractVector{&lt;:PDBTools.Atom}, trajectory_file::String)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/align.jl#L80-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.msd-Tuple{Vector{Vector{StaticArraysCore.SVector{3, Float64}}}}" href="#LumberjackToolkit.msd-Tuple{Vector{Vector{StaticArraysCore.SVector{3, Float64}}}}"><code>LumberjackToolkit.msd</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">msd(trajectory::Vector{Vector{SVector{3, Float64}}}; step=1, dim=collect(1:3))</code></pre><p>Calculate the mean square displacement (MSD) of a trajectory. The MSD is calculated using Green-Kubo relation: <code>&lt;r²(t)&gt; = MSD(t) = 1/N * Σ &lt;[r_i(t) - r_i(0)]²&gt;</code>. It is important to notice that trajectories must have been adjusted to approach:</p><pre><code class="nohighlight hljs">    traj = [
                [coord(t1), coord(t2), coord(t3), ..., coord(tmax)],    ## molecule 1
                [coord(t1), coord(t2), coord(t3), ..., coord(tmax)],    ## molecule 2
                [coord(t1), coord(t2), coord(t3), ..., coord(tmax)],    ## molecule 3
                ...
                [coord(t1), coord(t2), coord(t3), ..., coord(tmax)],    ## molecule N
        ]</code></pre><p><strong>Arguments</strong></p><ul><li><code>trajectory::Vector{Vector{SVector{3, Float64}}}</code>: A vector of vectors of 3D coordinates.</li><li><code>step::Int=1</code>: The time step to calculate the MSD.</li><li><code>dim::Vector{Int}=collect(1:3)</code>: The dimensions to calculate the MSD.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/diffusion.jl#L68-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.r_avg-Tuple{Vector{&lt;:Vector{StaticArraysCore.SVector{3, Float64}}}}" href="#LumberjackToolkit.r_avg-Tuple{Vector{&lt;:Vector{StaticArraysCore.SVector{3, Float64}}}}"><code>LumberjackToolkit.r_avg</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">r_avg(frames::Vector{&lt;:Vector{SVector{3, Float64}}})</code></pre><p>Calculate the average position of each atom inside the trajectory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/pca.jl#L16-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.readcoords-Tuple{AbstractVector{&lt;:PDBTools.Atom}, String}" href="#LumberjackToolkit.readcoords-Tuple{AbstractVector{&lt;:PDBTools.Atom}, String}"><code>LumberjackToolkit.readcoords</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readcoords(atoms::AbstractVector{&lt;:PDBTools.Atom}, pdbname::String)</code></pre><p>Read the coordinates of a trajectory in a PDB file. Returns a vector of vectors of coordinates of selected atoms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/utils.jl#L205-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.select_atoms-Tuple{Vector{PDBTools.Atom}, String, String, Int64, String}" href="#LumberjackToolkit.select_atoms-Tuple{Vector{PDBTools.Atom}, String, String, Int64, String}"><code>LumberjackToolkit.select_atoms</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">select_atoms(atom::Vector{PDBTools.Atom}, name::String, resname::String, resnum::Int64, segname::String)

Select the atoms that match the given name, residue name, residue number, and segment name.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/utils.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.simsteps-Tuple{Float64, Float64}" href="#LumberjackToolkit.simsteps-Tuple{Float64, Float64}"><code>LumberjackToolkit.simsteps</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/simulation.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.simulation_steps-Tuple{Int64}" href="#LumberjackToolkit.simulation_steps-Tuple{Int64}"><code>LumberjackToolkit.simulation_steps</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulation_steps(t_simulation::Int64; unit=&quot;ns&quot;, timestep=2.0, output=1000)

This function calculates the number of steps you need to set and the number of frames that you will get in the MD simulation.</code></pre><p><strong>Arguments</strong></p><ul><li><code>t_simulation</code>: The total simulation time in the specified unit.</li><li><code>unit</code>: The unit of the simulation time. It can be &quot;ns&quot; (nan</li><li><code>timestep</code>: The time step of the simulation in the specified unit.</li><li><code>output</code>: The frequency of frame storage during the MD simulation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/utils.jl#L14-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.vmd_get_charges-Tuple{String, String}" href="#LumberjackToolkit.vmd_get_charges-Tuple{String, String}"><code>LumberjackToolkit.vmd_get_charges</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vmd_get_charges(psf::String, pdb::String; newpdb=nothing, pdb_column=&quot;beta&quot;, vmd=&quot;vmd&quot;)</code></pre><p>Uses VMD to catch the charges inside the PSF file and transfer it to PDB file on b-factor or occupancy columns. Notice that you need VMD installed to run this code. Check it on: https://www.ks.uiuc.edu/Development/Download/download.cgi?PackageName=VMD.</p><p><strong>Arguments</strong></p><ul><li><code>psf::String</code> and <code>pdb::String</code>: the name of the raw files.</li><li><code>newpdb::String</code>: the name of the new PDB file with the charges. The default is <code>nothing</code> and it will generate a PDB on your temporary files.</li><li><code>pdb_column::String</code>: the column to store the charges. The default is <code>beta</code>.</li><li><code>vmd::String</code>: the VMD executable. The default is <code>vmd</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/vmd-scripts.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.write_frame!-Tuple{IO, AbstractVector{&lt;:PDBTools.Atom}, Chemfiles.Frame}" href="#LumberjackToolkit.write_frame!-Tuple{IO, AbstractVector{&lt;:PDBTools.Atom}, Chemfiles.Frame}"><code>LumberjackToolkit.write_frame!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_frame!(trajectory_pdb_file, atoms, frame</code></pre><p>Write a frame of a trajectory in the temporary PDB trajectory file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/utils.jl#L129-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.writepdb_trajectory-Tuple{String, String}" href="#LumberjackToolkit.writepdb_trajectory-Tuple{String, String}"><code>LumberjackToolkit.writepdb_trajectory</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">writepdb_trajectory(pdbname::String, trajectory::String; selection=&quot;all&quot;, first=1, last=nothing, step=1)</code></pre><p>Write a trajectory in a temporary PDB file. This is very useful when you want to visualize the edited trajectory in VMD. The MDLovoFit program uses this function to write the trajectory in a PDB file before the analysis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/utils.jl#L97-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.δ-Tuple{Float64, Float64, Float64}" href="#LumberjackToolkit.δ-Tuple{Float64, Float64, Float64}"><code>LumberjackToolkit.δ</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">δ(value::Float64, lower::Float64, upper::Float64)</code></pre><p>It is an indicator function that maps the elements inside <span>$x_lower ≤ x_value ≤ x_upper$</span> interval.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/density.jl#L283-L287">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LumberjackToolkit.ρ-Tuple{Vector{Float64}, Vector{MolSimToolkit.Point3D{Float64}}, Float64}" href="#LumberjackToolkit.ρ-Tuple{Vector{Float64}, Vector{MolSimToolkit.Point3D{Float64}}, Float64}"><code>LumberjackToolkit.ρ</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ρ(bins::Vector{Float64}, positions::Vector{Point3D{Float64}}, N::Float64; axis=&quot;z&quot;, prop=nothing)</code></pre><p>Computes the density for each bin interval given the frame positions. Here, we apply a normalization base on the bin dimensions, so all the frames will have the same <code>sum(ρ)</code>. The <code>prop</code> argument is used to compute the density of a specific property, like the atomic number, mass, or charge.</p><p><strong>Arguments</strong></p><ul><li><code>bins::Vector{Float64}</code>: a Vector{Float64} with the bin intervals.</li><li><code>positions::Vector{Point3D{Float64}}</code>: a Vector{Point3D{Float64}} with the atomic positions.</li><li><code>N::Float64</code>: a Float64 with the normalization factor.</li><li><code>axis::String</code>: a String with the axis flag.</li><li><code>prop::Vector{Float64}</code>: a Vector{Float64} with the property to be computed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cgtbatista/LumberjackToolkit.jl/blob/4399e645a2347f6b1c7dd792d822be9ca5e97f8b/src/density.jl#L246-L258">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 10 February 2025 15:24">Monday 10 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
